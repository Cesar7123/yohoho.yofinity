/*! */
/*!
 * infinity.js v1.0.0 - "Sogeking no shima deeeeeee - One Piece"
 * ~~~~~~~~~~~~~~~~~~
 *
 * Example of use HTML:
 * <a href="http://example.com/page/2" title="Next posts" rel="next">Loading...</a>
 *
 * Example of use JS:
 * $('body').infinity({
 *     buffer: 1000,
 *     navSelector: 'a[rel="next"]',
 *     success: function ($link, response){
 *         $link.before(response);
 *         $link.attr('href', '/page/2');
 *     },
 *     error: function ($link){
 *         $link.remove();
 *     }
 * });
 *
 * ~~~~~~~~~~~~~~~~~~
 * Copyright 2015 Achraf Chouk <achrafchouk@gmail.com>
 */
!function(a){"use strict";var b=function(b,c){var d=this;d.$el=b,d.options=a.extend({},c),d.$context=a(d.options.context),d.initialize()};b.prototype.options={},b.prototype.$el=null,b.prototype.$context=null,b.prototype.initialize=function(){var a=this,b=null;a.$context.on("scroll",function(c){b&&(clearTimeout(b),b=null),b=setTimeout(function(){a.check()},250)})},b.prototype.check=function(){var b=this,c=b.$el.find(b.options.navSelector);if(c.length){var d=b.$context.scrollTop()+b.$context.height();a.each(c,function(){var c=a(this),e=c.offset().top-d;e>b.options.buffer?b._log(e-b.options.buffer+"px before loading."):b.next(c)})}else b._log("End.")},b.prototype.next=function(b){var c=this,d=b.attr("href");"#"!=d&&""!=d&&(b.attr("data-loading")||a.ajax({url:d,beforeSend:function(){c._loading(b)},error:function(){c._error(b)},success:function(a){c._success(b,a)}}))},b.prototype._loading=function(a){var b=this;a.attr("data-loading",!0),b._log("Loading next page."),"function"==typeof b.options.loading&&b.options.loading(a)},b.prototype._error=function(a){var b=this;a.removeAttr("data-loading"),b._log("Error while loading next page."),"function"==typeof b.options.error&&b.options.error(a)},b.prototype._success=function(a,b){var c=this;a.removeAttr("data-loading"),c._log("Next page loaded."),"function"==typeof c.options.success&&c.options.success(a,b)},b.prototype._log=function(a){var b=this;b.options.debug&&"undefined"!=typeof console&&null!==console&&console.log("Infinity ~ "+a)};var c={init:function(c){if(!this.length)return!1;var d={buffer:1e3,context:window,debug:!1,error:null,loading:null,navSelector:'a[rel="next"]',success:null};return this.each(function(){c&&a.extend(d,c),new b(a(this),d)})},update:function(){},destroy:function(){}};a.fn.infinity=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.Infinity"):c.init.apply(this,arguments)}}(window.jQuery);